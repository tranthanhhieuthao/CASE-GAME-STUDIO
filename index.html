<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>START GAME_GOOD LUCK HAVE FUN</title>
</head>
<body>
<table style="width: 190px;height: 200px;border: solid 1px blue;position: absolute;background: antiquewhite">
    <tr><td><input type="button" value="Retart" style="width: 60px;height: 30px" onclick="retart()"/></td></tr>
    <tr><td>Score:<span id="Score"></span></td></tr>
    <tr><td><input type="button" value="RandomLeve" style="width: 100px;height: 30px" onclick="RandomLeve()"/></td></tr>
</table>
<canvas id="MyCanvas" width="1280" height="650"  style="border: solid 1px blue ;position: absolute;
left: 200px;background-image: url(Capture.PNG)"></canvas>

<script>
    // confirm("You want play this game ?");
    let CV =document.getElementById("MyCanvas");
    let ctx = CV.getContext('2d');
    let BroadGame =function (x,y) {
        this.x = x;
        this.y = y;
        this.Draw = function () {
            ctx.beginPath();
            ctx.rect( this.x,this.y,65,30);
            ctx.fillStyle = "rgb(15,100,147)";
            ctx.fill();
        };
    };
    let score =0;
    let Difi_Game =215;
    let sizeArrayx = 0;
    let sizeArrayy = 0;
    let mangx =[];
    let mangy =[];
    for (let j=0;j<6;j++) {
        for (let i = 0; i < 16; i++) {
            mangy.push(sizeArrayy);
            mangx.push(sizeArrayx);
            sizeArrayx += 80;
        }
        sizeArrayy += 35;
        sizeArrayx = 0
    }
    let Thanhdo = function (speed) {
        this.x = 600;
        this.y = 620;
        this.MoveRight = function () {
            this.x += speed;
        };
        this.MoveLeft = function () {
            this.x -=speed;
        };
        this.Draw = function () {
            ctx.beginPath();
            ctx.rect(this.x,this.y,200,10);
            ctx.fillStyle = "rgb(5,90,17)";
            ctx.fill();
        };
    };

    let speedx =5;
    let speedy =5;
    let quabong = function (x,y) {
        this.x =x;
        this.y =y;
        this.draw = function () {
            ctx.beginPath();
            ctx.arc(this.x,this.y,10,0,2*Math.PI);
            ctx.fillStyle ="rgb(125,10,17)";
            ctx.fill();
            ctx.closePath();
        };
        this.MoveRight =function () {
            this.x += speedx;
        };
        this.MoveLeft =function () {
            this.y +=speedy;
        }
    };

    let Quabong =new quabong(500,300);
    let thanhdo = new Thanhdo(30);
    function moveselection(evt) {
        switch (evt.keyCode) {
            case 37:
                thanhdo.MoveLeft();
                break;
            case 39:
                thanhdo.MoveRight();
                break;
        }
    }
    let i=0;
    let Anhno = function () {
        this.Anhno =["Anhno/anh1.png","Anhno/anh2.png","Anhno/anh3.png","Anhno/anh4.png","Anhno/anh5.png","Anhno/tanh6.png",
            "Anhno/anh7.png","Anhno/anh8.png","Anhno/anh9.png","Anhno/anh10.png","no/Aanhno1.png","Anhno/anhno2.png","Anhno/anhno3.png","Anhno/anhno4.png","Anhno/anhno5.png"];
        this.Animation = function (x,y) {
            let image = new Image();
                image.onload = function () {
                    ctx.drawImage(image, x, y, 100, 100)
                };
                image.src = this.Anhno[i];
                i++;
            }
    };
    let anhno = new Anhno();
    function retart() {
        window.location.reload();
    }

    function RandomLeve() {
        mangy.push(Difi_Game);
        Difi_Game +=35;
    }

    function chay() {
        ctx.clearRect(0, 0, CV.width, CV.height);
        anhno.Animation(600, 200);
        Quabong.draw();
        Quabong.MoveLeft();
        Quabong.MoveRight();
        if ( thanhdo.y-10 === Quabong.y && Quabong.x - thanhdo.x >0 && Quabong.x - thanhdo.x<230) {
            speedy =-speedy;
        }
        if (Quabong.x < 0 || Quabong.x >1280 ) {
            speedx = -speedx;
        }
        if (Quabong.y < 0  ) {
                speedy = -speedy;
        }
        if (Quabong.y === CV.height){
            alert("Ban da thua,diem cua ban la"+" "+score);
            location.reload();
        }
        for (let i=0;i<mangx.length;i++){
                let drawgame = new BroadGame(mangx[i],mangy[i]);
                drawgame.Draw();
            }
        for (let i = mangx.length-1;i>0;i--) {
                if (Quabong.x > mangx[i] && Quabong.x < mangx[i] + 65 &&
                    Quabong.y < mangy[i] + 30 && Quabong.y > mangy[i]) {
                    // anhno.Animation(mangx[i], mangy[i]);
                    speedy = -speedy;
                    mangx.splice(i, 1);
                    mangy.splice(i, 1);
                    score++;
                }

            }
        thanhdo.Draw();
        window.addEventListener("keydown", moveselection);
        document.getElementById("Score").innerHTML =score;
        setTimeout(chay,20);
    }

    chay();





</script>
</body>
</html>